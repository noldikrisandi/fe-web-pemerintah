import{f as G,e as _,n as H,j as s,d as O,r as o,p as W,q as z,b,B as L,H as R,s as q,t as P,v as A,w as n,x as J,y as i,m as f,M as Q,z as V,A as X,C as Y,D as Z,F as c,E as h,G as m}from"./index-CySiJ9US.js";import{F as k}from"./chunk-WWJYOSXC-C_O2xmI7.js";var M=G((y,v)=>{const{className:S,...g}=y,N=_("chakra-modal__footer",S),p={display:"flex",alignItems:"center",justifyContent:"flex-end",...H().footer};return s.jsx(O.footer,{ref:v,...g,__css:p,className:N})});M.displayName="ModalFooter";const as=()=>{const[y,v]=o.useState([]),[S,g]=o.useState(!0),[N,E]=o.useState(null),[p,F]=o.useState(null),[a,I]=o.useState({id:"",email:"",nama:"",nik:"",nokk:"",wa:"",status:""}),[r,K]=o.useState({}),{isOpen:U,onOpen:T,onClose:w}=W(),x=z();o.useEffect(()=>{C()},[]);const C=async()=>{var e,t,l,u;g(!0);try{const j=await b.get("/users");v(j.data)}catch(j){E(((t=(e=j.response)==null?void 0:e.data)==null?void 0:t.error)||"Gagal mengambil data."),x({title:"Gagal memuat data.",description:((u=(l=j.response)==null?void 0:l.data)==null?void 0:u.error)||j.message,status:"error",duration:5e3,isClosable:!0})}finally{g(!1)}},D=()=>{let e={};return/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/.test(a.email)||(e.email="Email harus valid"),/^[0-9]{16}$/.test(a.nik)||(e.nik="NIK harus berisi 16 digit angka"),/^[0-9]{16}$/.test(a.nokk)||(e.nokk="Nomor Kartu Keluarga harus berisi 16 digit angka"),/^((\+62|08)[0-9]{9,})$/.test(a.wa)||(e.wa="Nomor WA harus valid dan diawali +62 atau 08"),K(e),Object.keys(e).length===0},d=e=>{I({...a,[e.target.name]:e.target.value})},$=async()=>{var e,t;if(D())try{p&&(await b.put(`/users/${p.id}`,a),x({title:"User berhasil diperbarui!",status:"success"})),C(),w()}catch(l){x({title:"Terjadi kesalahan!",description:((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.error)||"Gagal menyimpan user.",status:"error",duration:5e3,isClosable:!0})}},B=async e=>{var t,l;if(window.confirm("Apakah Anda yakin ingin menghapus user ini?"))try{await b.delete(`/users/${e}`),x({title:"User berhasil dihapus!",status:"success"}),C()}catch(u){x({title:"Gagal menghapus user!",description:((l=(t=u.response)==null?void 0:t.data)==null?void 0:l.error)||u.message,status:"error"})}};return s.jsxs(L,{maxW:"7xl",mx:"auto",p:4,children:[s.jsx(R,{as:"h1",mb:6,textAlign:"center",children:"Daftar Pengguna"}),s.jsxs(q,{variant:"simple",children:[s.jsx(P,{children:s.jsxs(A,{children:[s.jsx(n,{children:"ID"}),s.jsx(n,{children:"Email"}),s.jsx(n,{children:"Nama"}),s.jsx(n,{children:"NIK"}),s.jsx(n,{children:"Nomor Kartu Keluarga"}),s.jsx(n,{children:"Nomor WA Aktif"}),s.jsx(n,{children:"Status User"}),s.jsx(n,{children:"Aksi"})]})}),s.jsx(J,{children:y.map(e=>s.jsxs(A,{children:[s.jsx(i,{children:e.id}),s.jsx(i,{children:e.email}),s.jsx(i,{children:e.nama}),s.jsx(i,{children:e.nik}),s.jsx(i,{children:e.nokk}),s.jsx(i,{children:e.wa}),s.jsx(i,{children:e.status}),s.jsxs(i,{children:[s.jsx(f,{colorScheme:"yellow",size:"sm",mr:2,onClick:()=>{F(e),I(e),T()},children:"Edit"}),s.jsx(f,{colorScheme:"red",size:"sm",onClick:()=>B(e.id),children:"Hapus"})]})]},e.id))})]}),s.jsxs(Q,{isOpen:U,onClose:w,children:[s.jsx(V,{}),s.jsxs(X,{children:[s.jsx(Y,{children:"Edit User"}),s.jsxs(Z,{children:[s.jsxs(c,{isInvalid:r.email,children:[s.jsx(h,{children:"Email"}),s.jsx(m,{name:"email",value:a.email,onChange:d}),s.jsx(k,{children:r.email})]}),s.jsxs(c,{mt:2,isInvalid:r.nama,children:[s.jsx(h,{children:"Nama"}),s.jsx(m,{name:"nama",value:a.nama,onChange:d})]}),s.jsxs(c,{mt:2,isInvalid:r.nik,children:[s.jsx(h,{children:"NIK"}),s.jsx(m,{name:"nik",value:a.nik,onChange:d}),s.jsx(k,{children:r.nik})]}),s.jsxs(c,{mt:2,isInvalid:r.nokk,children:[s.jsx(h,{children:"Nomor Kartu Keluarga"}),s.jsx(m,{name:"nokk",value:a.nokk,onChange:d}),s.jsx(k,{children:r.nokk})]}),s.jsxs(c,{mt:2,isInvalid:r.wa,children:[s.jsx(h,{children:"Nomor WA Aktif"}),s.jsx(m,{name:"wa",value:a.wa,onChange:d}),s.jsx(k,{children:r.wa})]}),s.jsxs(c,{mt:2,isInvalid:r.status,children:[s.jsx(h,{children:"Status"}),s.jsx(m,{name:"status",value:a.status,onChange:d}),s.jsx(k,{children:r.status})]})]}),s.jsxs(M,{children:[s.jsx(f,{colorScheme:"blue",mr:3,onClick:$,children:"Simpan"}),s.jsx(f,{onClick:w,children:"Batal"})]})]})]})]})};export{as as default};
